[
    {
        "name": "Drain",
        "trigger": "Drain",
        "level_nid": "5x",
        "condition": "region.nid == 'Drain'",
        "commands": [],
        "only_once": true,
        "priority": 20,
        "_source": [
            "choice;PullLever;Pull the lever? (<red>Will skip most of chapter</>);Yes,No",
            "if;game.game_vars['PullLever'] == 'Yes'",
            "    if;unit.nid == 'HorseyGirl'",
            "        add_portrait;HorseyGirl;Right",
            "        bop_portrait;HorseyGirl",
            "        speak;Narrator;{v:HorseyGirlName} points aggressively at a lever.;;;narration_top",
            "        bop_portrait;HorseyGirl",
            "        speak;Narrator;{v:HorseyGirlName} aggressively motions to take cover.;;;narration_top",
            "        remove_portrait;HorseyGirl",
            "    else",
            "        add_portrait;{unit};Right",
            "        speak;{unit};Ok!|I found the lever!|Everyone take cover!",
            "        remove_portrait;{unit}",
            "    end",
            "    transition;close;500",
            "    sound;WaterBlast",
            "    wait;800",
            "    sound;WaterBlast",
            "    wait;800",
            "    sound;WaterBlast",
            "    wait;800",
            "    separate;Ephraim",
            "    separate;Orson",
            "    separate;Forde",
            "    separate;Kyle",
            "    separate;HorseyBoy",
            "    separate;HorseyGirl",
            "    remove_all_units",
            "    add_unit;Zonta;13,7;immediate;closest",
            "    add_unit;Ephraim;13,9;immediate;closest",
            "    add_unit;Forde;14,9;immediate;closest",
            "    add_unit;Kyle;12,9;immediate;closest",
            "    add_unit;Orson;13,10;immediate;closest",
            "    if;game.game_vars['HorseyJoin'] == 'Yes'",
            "        add_unit;HorseyBoy;12,11;immediate;closest",
            "        add_unit;HorseyGirl;14,11;immediate;closest",
            "    else",
            "    end",
            "    has_finished;{unit}",
            "    reset;Ephraim",
            "    reset;Kyle",
            "    reset;Forde",
            "    reset;Orson",
            "    if;game.game_vars['HorseyJoin'] == 'Yes'",
            "        reset;HorseyBoy",
            "        reset;HorseyGirl",
            "    else",
            "    end",
            "    center_cursor;Ephraim;immediate",
            "    transition;open;500",
            "    flicker_cursor;Ephraim",
            "    wait;300",
            "    multi_add_portrait;Ephraim;Right;Zonta;Left",
            "    speak;Zonta;What in the world happened?!|Where did all that water come from?!|You!|Ephraim, you did this, didn't you?!",
            "    speak;Ephraim;Correct.|We got some great info and now we are here to take over this castle.",
            "    speak;Zonta;Grrrrr!...|Well, I'm still here!|You'll have to get through me first!",
            "    multi_remove_portrait;Ephraim;Zonta",
            "    reset;Ephraim",
            "    reset;Kyle",
            "    reset;Forde",
            "    reset;Orson",
            "    remove_region;Drain",
            "    complete_achievement;ch5xa;true;banner",
            "    give_item;Ephraim;Energy_Ring_Consumable",
            "else",
            "end"
        ],
        "nid": "5x Drain"
    }
]