[
    {
        "name": "RuinsRandomizer",
        "trigger": "level_start",
        "level_nid": "LRF4B",
        "condition": "True",
        "commands": [],
        "only_once": false,
        "priority": 20,
        "_source": [
            "#pyev1",
            "import random",
            "$chapter_title",
            "enemyunitsall=game.get_enemy_units(False)",
            "for i in range(len(enemyunitsall)): ",
            "    $change_team enemyunitsall[i] \"enemy2\"",
            "#Generate variables",
            "items=['Demon Surge','Evil Eye','Rotten Claw','Fiery Fang','Fire Breath','Heal','Iron Sword','Iron Bow','Iron Axe','Iron Lance','Lightning','Fire','Flux']",
            "daggers=['Inferno_Dagger','Lokis_Dagger','Zap_Dagger','Venom_Dagger']",
            "swords=['Heat_Sword','Mist_Sword','Lakeburst_Sword','Shiver_Sword','Levin_Sword','Gaia_Blade','Holy_Sword_Shop','Nightingale']",
            "lances=['Blue_Fire_Lance','Mist_Lance','Geyser_Lance','Glacier_Lance','Storm_Sword','Shielder_Lance','Seraphim_Lance','Fenrir_Spear']",
            "axes=['Wrath_Axe', 'Hurricane_Axe', 'Flowing_Axe', 'Glacier_Axe', 'Bolt_Axe', 'Jagged_Axe', 'Sol_Axe', 'Devil Axe']",
            "bows=['Twist_Bow', 'Gale_Bow', 'Aqua_Burst', 'Glacier_Bow', 'Arc_Bow', 'Stone_Edge', 'Shine_Bow', 'Abyss_Bow']",
            "staves=['Beam_Staff','Cyclone_Staff','Maelstrom_Staff','Ramuh_Staff','Shiva_Staff','Tremor_Staff','Holy_Staff','Night_Sky']",
            "anima=['Bolganone','Tempest','Geyser_Blasts','Glacies','Thoron','Volcano']",
            "light=['Aureola','Shining_Aura','Goddess_Bomb','Plague','Aura_Glacier']",
            "dark=['Mephiles','Dark_Bolt','Hellfire','Misleading_Light','Ruination']",
            "fangs=['Frost_Fang','Fire_Fang','Thunder_Fang','Abyss_Fang']",
            "claws=['Frost_Claw','Fire_Claw','Thunder_Claw','Gilded_Claw']",
            "breaths=['Fire_Breath','Sea_Breath','Magic_Breath','Arcane_Breath','Black_Breath','Nova_Breath','Abyss_Breath','Fell_Breath']",
            "eyes=['Insight_Eye','Apocalypse_Eye']",
            "stones=['Shadowshot','Stone']",
            "classes=['T3_Marshall','T3_Black_Knight','T3_Baron','T3_Elephant_Rider','T3_Male_War_Monk','T3_Male_Archsage','T3_Executioner','T3_Magiteck_Knight']",
            "drops=['Angelic_Robe_Consumable_P','Energy_Ring_P','Swiftsole_Consumable_P','Speedwing_Consumable_P','Dragonshield_Consumable_P','Secret_Book_Consumable_P','Talisman_Consumable_P','Goddess_Icon_Consumable_P','Body_Ring_P']",
            "pnone=.97",
            "enemyunits=game.get_enemy_units()",
            "bossunit=random.randint(0,len(enemyunits)-1)",
            "equippable_items = {",
            "    'T3_Marshall': ['Iron Lance','Iron Sword','Iron Axe','Iron Bow'],",
            "    'T3_Black_Knight': ['Iron Lance','Iron Sword','Iron Axe'],",
            "    'T3_Baron': ['Iron Lance','Iron Sword','Iron Axe','Fire'],",
            "    'T3_Elephant_Rider': ['Iron Lance','Iron Sword','Iron Axe','Iron Bow'],",
            "    'T3_Male_War_Monk': ['Iron Axe','Heal','Lightning'],",
            "    'T3_Male_Archsage': ['Lightning','Heal','Flux','Fire'],",
            "    'T3_Executioner': ['Iron Sword','Heal','Flux'],",
            "    'T3_Magiteck_Knight': ['Iron Bow','Iron Sword','Anima']",
            "}",
            "#Randomize positions",
            "for i in range(len(enemyunits)):",
            "    $move_unit enemyunits[i].nid (enemyunits[i].position[0]+random.randint(-1,1),enemyunits[i].position[1]+random.randint(-1,1)) \"immediate\" \"closest\",no_block",
            "#Ensure created generics get a random weapon they can use   ",
            "    unit_class1 = random.choice(classes)",
            "    unit_class2 = random.choice(classes)",
            "    valid_items1 = equippable_items.get(unit_class1, [])",
            "    valid_items2 = equippable_items.get(unit_class2, [])",
            "    if valid_items1:",
            "        selected_item1 = random.choice(valid_items1)",
            "    else:",
            "        selected_item1 = None ",
            "    if valid_items2:",
            "        selected_item2 = random.choice(valid_items2)",
            "    else:",
            "        selected_item2 = None ",
            "    ",
            "#Add generics with random class, level, and item",
            "    ",
            "    $make_generic str(i) unit_class1 random.randint(6, 8) \"enemy2\" \"Defend\" \"Ruin_Guardian\" ItemList=[selected_item1]      ",
            "    $make_generic str(i+200) unit_class2 random.randint(6, 8) \"enemy2\" \"Defend\" \"Ruin_Guardian\" ItemList=[selected_item2] ",
            "    $add_unit str(i) enemyunits[i].nid \"immediate\" \"closest\"",
            "    if unit_class1==\"T3_Marshall\" or unit_class1==\"T3_Elephant_Rider\":",
            "        $give_wexp str(i) \"Axe\" 360,no_banner",
            "        $give_wexp str(i) \"Bow\" 360,no_banner",
            "        $give_wexp str(i) \"Lance\" 360,no_banner",
            "        $give_wexp str(i) \"Sword\" 360,no_banner",
            "        $remove_item str(i) selected_item1,no_banner",
            "        $give_item str(i) random.choice(axes),no_banner",
            "        $give_item str(i) random.choice(bows),no_banner",
            "        $give_item str(i) random.choice(lances),no_banner",
            "        $give_item str(i) random.choice(swords),no_banner",
            "    elif unit_class1==\"T3_Black_Knight\":",
            "        $give_wexp str(i) \"Axe\" 360,no_banner",
            "        $give_wexp str(i) \"Lance\" 360,no_banner",
            "        $give_wexp str(i) \"Sword\" 360,no_banner",
            "        $remove_item str(i) selected_item1,no_banner",
            "        $give_item str(i) random.choice(axes),no_banner",
            "        $give_item str(i) random.choice(lances),no_banner",
            "        $give_item str(i) random.choice(swords),no_banner",
            "    elif unit_class1==\"T3_Baron\":",
            "        $give_wexp str(i) \"Axe\" 360,no_banner",
            "        $give_wexp str(i) \"Anima\" 360,no_banner",
            "        $give_wexp str(i) \"Lance\" 360,no_banner",
            "        $give_wexp str(i) \"Sword\" 360,no_banner",
            "        $remove_item str(i) selected_item1,no_banner",
            "        $give_item str(i) random.choice(axes),no_banner",
            "        $give_item str(i) random.choice(anima),no_banner",
            "        $give_item str(i) random.choice(lances),no_banner",
            "        $give_item str(i) random.choice(swords),no_banner",
            "    elif unit_class1==\"T3_Male_War_Monk\":",
            "        $give_wexp str(i) \"Axe\" 360,no_banner",
            "        $give_wexp str(i) \"Light\" 360,no_banner",
            "        $give_wexp str(i) \"Staff\" 360,no_banner",
            "        $remove_item str(i) selected_item1,no_banner",
            "        $give_item str(i) random.choice(axes),no_banner",
            "        $give_item str(i) random.choice(light),no_banner",
            "        $give_item str(i) random.choice(staves),no_banner",
            "    elif unit_class1==\"T3_Male_Archsage\":",
            "        $give_wexp str(i) \"Dark\" 360,no_banner",
            "        $give_wexp str(i) \"Light\" 360,no_banner",
            "        $give_wexp str(i) \"Anima\" 360,no_banner",
            "        $give_wexp str(i) \"Staff\" 360,no_banner",
            "        $remove_item str(i) selected_item1,no_banner",
            "        $give_item str(i) random.choice(dark),no_banner",
            "        $give_item str(i) random.choice(light),no_banner",
            "        $give_item str(i) random.choice(anima),no_banner",
            "        $give_item str(i) random.choice(staves),no_banner",
            "    elif unit_class1==\"T3_Executioner\":",
            "        $give_wexp str(i) \"Sword\" 360,no_banner",
            "        $give_wexp str(i) \"Dark\" 360,no_banner",
            "        $give_wexp str(i) \"Staff\" 360,no_banner",
            "        $remove_item str(i) selected_item1,no_banner",
            "        $give_item str(i) random.choice(swords),no_banner",
            "        $give_item str(i) random.choice(dark),no_banner",
            "        $give_item str(i) random.choice(staves),no_banner",
            "    elif unit_class1==\"T3_Magiteck_Knight\":",
            "        $give_wexp str(i) \"Sword\" 360,no_banner",
            "        $give_wexp str(i) \"Anima\" 360,no_banner",
            "        $give_wexp str(i) \"Bow\" 360,no_banner",
            "        $remove_item str(i) selected_item1,no_banner",
            "        $give_item str(i) random.choice(swords),no_banner",
            "        $give_item str(i) random.choice(anima),no_banner",
            "        $give_item str(i) random.choice(bows),no_banner",
            "    ",
            "    ",
            "    if i == bossunit:",
            "        $add_tag str(i) \"Boss\"",
            "#Generate paired up enemies    ",
            "    pairuprandom=random.randint(1,100)",
            "    if pairuprandom<26:",
            "        $add_unit str(i+200) enemyunits[i].nid \"immediate\" \"closest\"",
            "        $pair_up str(i) str(i+200)",
            "    if unit_class2==\"T3_Marshall\" or unit_class2==\"T3_Elephant_Rider\":",
            "        $give_wexp str(i+200) \"Axe\" 360,no_banner",
            "        $give_wexp str(i+200) \"Bow\" 360,no_banner",
            "        $give_wexp str(i+200) \"Lance\" 360,no_banner",
            "        $give_wexp str(i+200) \"Sword\" 360,no_banner",
            "        $remove_item str(i+200) selected_item2,no_banner",
            "        $give_item str(i+200) random.choice(axes),no_banner",
            "        $give_item str(i+200) random.choice(bows),no_banner",
            "        $give_item str(i+200) random.choice(lances),no_banner",
            "        $give_item str(i+200) random.choice(swords),no_banner",
            "    elif unit_class2==\"T3_Black_Knight\":",
            "        $give_wexp str(i+200) \"Axe\" 360,no_banner",
            "        $give_wexp str(i+200) \"Lance\" 360,no_banner",
            "        $give_wexp str(i+200) \"Sword\" 360,no_banner",
            "        $remove_item str(i+200) selected_item2,no_banner",
            "        $give_item str(i+200) random.choice(axes),no_banner",
            "        $give_item str(i+200) random.choice(lances),no_banner",
            "        $give_item str(i+200) random.choice(swords),no_banner",
            "    elif unit_class2==\"T3_Baron\":",
            "        $give_wexp str(i+200) \"Axe\" 360,no_banner",
            "        $give_wexp str(i+200) \"Anima\" 360,no_banner",
            "        $give_wexp str(i+200) \"Lance\" 360,no_banner",
            "        $give_wexp str(i+200) \"Sword\" 360,no_banner",
            "        $remove_item str(i+200) selected_item2,no_banner",
            "        $give_item str(i+200) random.choice(axes),no_banner",
            "        $give_item str(i+200) random.choice(anima),no_banner",
            "        $give_item str(i+200) random.choice(lances),no_banner",
            "        $give_item str(i+200) random.choice(swords),no_banner",
            "    elif unit_class2==\"T3_Male_War_Monk\":",
            "        $give_wexp str(i+200) \"Axe\" 360,no_banner",
            "        $give_wexp str(i+200) \"Light\" 360,no_banner",
            "        $give_wexp str(i+200) \"Staff\" 360,no_banner",
            "        $remove_item str(i+200) selected_item2,no_banner",
            "        $give_item str(i+200) random.choice(axes),no_banner",
            "        $give_item str(i+200) random.choice(light),no_banner",
            "        $give_item str(i+200) random.choice(staves),no_banner",
            "    elif unit_class2==\"T3_Male_Archsage\":",
            "        $give_wexp str(i+200) \"Dark\" 360,no_banner",
            "        $give_wexp str(i+200) \"Light\" 360,no_banner",
            "        $give_wexp str(i+200) \"Anima\" 360,no_banner",
            "        $give_wexp str(i+200) \"Staff\" 360,no_banner",
            "        $remove_item str(i+200) selected_item2,no_banner",
            "        $give_item str(i+200) random.choice(dark),no_banner",
            "        $give_item str(i+200) random.choice(light),no_banner",
            "        $give_item str(i+200) random.choice(anima),no_banner",
            "        $give_item str(i+200) random.choice(staves),no_banner",
            "    elif unit_class2==\"T3_Executioner\":",
            "        $give_wexp str(i+200) \"Sword\" 360,no_banner",
            "        $give_wexp str(i+200) \"Dark\" 360,no_banner",
            "        $give_wexp str(i+200) \"Staff\" 360,no_banner",
            "        $remove_item str(i+200) selected_item2,no_banner",
            "        $give_item str(i+200) random.choice(swords),no_banner",
            "        $give_item str(i+200) random.choice(dark),no_banner",
            "        $give_item str(i+200) random.choice(staves),no_banner",
            "    elif unit_class2==\"T3_Magiteck_Knight\":",
            "        $give_wexp str(i+200) \"Sword\" 360,no_banner",
            "        $give_wexp str(i+200) \"Anima\" 360,no_banner",
            "        $give_wexp str(i+200) \"Bow\" 360,no_banner",
            "        $remove_item str(i+200) selected_item2,no_banner",
            "        $give_item str(i+200) random.choice(swords),no_banner",
            "        $give_item str(i+200) random.choice(anima),no_banner",
            "        $give_item str(i+200) random.choice(bows),no_banner",
            "    ",
            "        ",
            "        if random.random() < pnone:",
            "            $give_item str(i+200) random.choice([None])",
            "        else: ",
            "            $give_item str(i+200) random.choice(drops),droppable no_banner",
            "       ",
            "#Assign random drops",
            "    if random.random() < pnone:",
            "        $give_item str(i) random.choice([None])",
            "    else: ",
            "        $give_item str(i) random.choice(drops),droppable no_banner",
            "#Clean up original units                  ",
            "    $remove_unit enemyunits[i].nid \"immediate\""
        ],
        "nid": "LRF4B RuinsRandomizer"
    }
]